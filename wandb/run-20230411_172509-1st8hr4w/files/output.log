Load dataset ...
test points sampled
Start training...
Epoch 1 (1/2000):









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.48it/s]
 21%|█████████████████▋                                                                  | 4/19 [00:00<00:01,  8.68it/s]
Train Epoch Accuracy: 0.14922145009040833
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.97it/s]
  3%|██▎                                                                                 | 2/73 [00:00<00:14,  4.83it/s]
TEST (inference) time: 1.9444868564605713s
Test Instance Accuracy: 0.09169550240039825, Class Accuracy: 0.09137158945193817
Best Instance Accuracy: 0.09169550240039825, Class Accuracy: 0.09137158945193817










 99%|█████████████████████████████████████████████████████████████████████████████████▊ | 72/73 [00:20<00:00,  3.48it/s]
Train Epoch Accuracy: 0.2089100331068039
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.52it/s]
 89%|██████████████████████████████████████████████████████████████████████████▎        | 17/19 [00:01<00:00,  9.84it/s]
TEST (inference) time: 1.9392459392547607s
Test Instance Accuracy: 0.2820069193840027, Class Accuracy: 0.14305219544370296
Best Instance Accuracy: 0.2820069193840027, Class Accuracy: 0.14305219544370296
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.89it/s]









 95%|██████████████████████████████████████████████████████████████████████████████▍    | 69/73 [00:19<00:01,  3.46it/s]
Train Epoch Accuracy: 0.23356401920318604
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.50it/s]
 47%|███████████████████████████████████████▊                                            | 9/19 [00:00<00:01,  9.44it/s]
TEST (inference) time: 1.9537389278411865s
Test Instance Accuracy: 0.30276817083358765, Class Accuracy: 0.18341242068226332
Best Instance Accuracy: 0.30276817083358765, Class Accuracy: 0.18341242068226332
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.90it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.51it/s]
  5%|████▍                                                                               | 1/19 [00:00<00:02,  7.14it/s]
Train Epoch Accuracy: 0.28287196159362793
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 10.03it/s]
  1%|█▏                                                                                  | 1/73 [00:00<00:14,  4.92it/s]
TEST (inference) time: 1.9229333400726318s
Test Instance Accuracy: 0.2647058963775635, Class Accuracy: 0.2045948378228706
Best Instance Accuracy: 0.30276817083358765, Class Accuracy: 0.2045948378228706










 97%|████████████████████████████████████████████████████████████████████████████████▋  | 71/73 [00:20<00:00,  3.50it/s]
Train Epoch Accuracy: 0.2846020758152008
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.51it/s]
 74%|█████████████████████████████████████████████████████████████▏                     | 14/19 [00:01<00:00,  9.76it/s]
TEST (inference) time: 1.933535099029541s
Test Instance Accuracy: 0.29584774374961853, Class Accuracy: 0.16791870318085306
Best Instance Accuracy: 0.30276817083358765, Class Accuracy: 0.2045948378228706
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.94it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.52it/s]
 37%|██████████████████████████████▉                                                     | 7/19 [00:00<00:01,  9.14it/s]
Train Epoch Accuracy: 0.27076125144958496
Train Epoch Loss: 1.1692791132077778
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.87it/s]
  4%|███▍                                                                                | 3/73 [00:00<00:15,  4.57it/s]
Test Instance Accuracy: 0.32698962092399597, Class Accuracy: 0.20610700847118518
Best Instance Accuracy: 0.32698962092399597, Class Accuracy: 0.20610700847118518









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.51it/s]
  0%|                                                                                            | 0/19 [00:00<?, ?it/s]
Train Epoch Accuracy: 0.2975778579711914
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.89it/s]
  0%|                                                                                            | 0/73 [00:00<?, ?it/s]
TEST (inference) time: 1.940319538116455s
Test Instance Accuracy: 0.37370243668556213, Class Accuracy: 0.2714539771769025
Best Instance Accuracy: 0.37370243668556213, Class Accuracy: 0.2714539771769025










 96%|███████████████████████████████████████████████████████████████████████████████▌   | 70/73 [00:19<00:00,  3.48it/s]
Train Epoch Accuracy: 0.2954152226448059
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.52it/s]
 63%|████████████████████████████████████████████████████▍                              | 12/19 [00:01<00:00,  9.73it/s]
TEST (inference) time: 1.9319968223571777s
Test Instance Accuracy: 0.3425605595111847, Class Accuracy: 0.22494240234669025
Best Instance Accuracy: 0.37370243668556213, Class Accuracy: 0.2714539771769025
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.93it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.52it/s]
 26%|██████████████████████                                                              | 5/19 [00:00<00:01,  8.54it/s]
Train Epoch Accuracy: 0.3096885681152344
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.87it/s]
  3%|██▎                                                                                 | 2/73 [00:00<00:14,  4.84it/s]
TEST (inference) time: 1.9452390670776367s
Test Instance Accuracy: 0.34602075815200806, Class Accuracy: 0.28069384999384134
Best Instance Accuracy: 0.37370243668556213, Class Accuracy: 0.28069384999384134










 99%|█████████████████████████████████████████████████████████████████████████████████▊ | 72/73 [00:20<00:00,  3.48it/s]
Train Epoch Accuracy: 0.31098616123199463
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.51it/s]
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.95it/s]
TEST (inference) time: 1.9277114868164062s
Test Instance Accuracy: 0.3754325211048126, Class Accuracy: 0.252906053963782
Best Instance Accuracy: 0.3754325211048126, Class Accuracy: 0.28069384999384134
Epoch 11 (11/2000):









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.47it/s]
 37%|██████████████████████████████▉                                                     | 7/19 [00:00<00:01,  8.08it/s]
Train Epoch Accuracy: 0.32915225625038147
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:02<00:00,  9.08it/s]
  3%|██▎                                                                                 | 2/73 [00:00<00:14,  4.81it/s]
TEST (inference) time: 2.1115262508392334s
Test Instance Accuracy: 0.4013840854167938, Class Accuracy: 0.3101970003523083
Best Instance Accuracy: 0.4013840854167938, Class Accuracy: 0.3101970003523083










 96%|███████████████████████████████████████████████████████████████████████████████▌   | 70/73 [00:20<00:00,  3.38it/s]
Train Epoch Accuracy: 0.3442906439304352
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.40it/s]
 58%|████████████████████████████████████████████████                                   | 11/19 [00:01<00:00,  9.46it/s]
TEST (inference) time: 1.9923129081726074s
Test Instance Accuracy: 0.3858131468296051, Class Accuracy: 0.2896643972146673
Best Instance Accuracy: 0.4013840854167938, Class Accuracy: 0.3101970003523083
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.64it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.45it/s]
  0%|                                                                                            | 0/19 [00:00<?, ?it/s]
Train Epoch Accuracy: 0.34775087237358093
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.88it/s]
  0%|                                                                                            | 0/73 [00:00<?, ?it/s]
TEST (inference) time: 1.941122055053711s
Test Instance Accuracy: 0.387543261051178, Class Accuracy: 0.2769433103514626
Best Instance Accuracy: 0.4013840854167938, Class Accuracy: 0.3101970003523083










 96%|███████████████████████████████████████████████████████████████████████████████▌   | 70/73 [00:19<00:00,  3.47it/s]
Train Epoch Accuracy: 0.33910036087036133
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.51it/s]
 63%|████████████████████████████████████████████████████▍                              | 12/19 [00:01<00:00,  9.68it/s]
TEST (inference) time: 1.9505364894866943s
Test Instance Accuracy: 0.38062283396720886, Class Accuracy: 0.2625287963900389
Best Instance Accuracy: 0.4013840854167938, Class Accuracy: 0.3101970003523083
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.85it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.44it/s]
  5%|████▍                                                                               | 1/19 [00:00<00:03,  5.60it/s]
Train Epoch Accuracy: 0.37197232246398926
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.66it/s]
  0%|                                                                                            | 0/73 [00:00<?, ?it/s]
TEST (inference) time: 1.9853637218475342s
Test Instance Accuracy: 0.40830451250076294, Class Accuracy: 0.30743584081447994
Best Instance Accuracy: 0.40830451250076294, Class Accuracy: 0.3101970003523083










100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.40it/s]
 32%|██████████████████████████▌                                                         | 6/19 [00:00<00:01,  8.81it/s]
Train Epoch Accuracy: 0.3819204270839691
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.73it/s]
  3%|██▎                                                                                 | 2/73 [00:00<00:15,  4.48it/s]
TEST (inference) time: 1.9722397327423096s
Test Instance Accuracy: 0.4048442840576172, Class Accuracy: 0.30278154360608056
Best Instance Accuracy: 0.40830451250076294, Class Accuracy: 0.3101970003523083










 99%|█████████████████████████████████████████████████████████████████████████████████▊ | 72/73 [00:20<00:00,  3.47it/s]
Train Epoch Accuracy: 0.3983564078807831
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.47it/s]
 84%|█████████████████████████████████████████████████████████████████████▉             | 16/19 [00:01<00:00,  9.72it/s]
TEST (inference) time: 1.965646505355835s
Test Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.31886416222965724
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.31886416222965724
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.76it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.50it/s]
 42%|███████████████████████████████████▎                                                | 8/19 [00:00<00:01,  9.39it/s]
Train Epoch Accuracy: 0.4005190432071686
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.90it/s]
  4%|███▍                                                                                | 3/73 [00:00<00:16,  4.37it/s]
TEST (inference) time: 1.9384641647338867s
Test Instance Accuracy: 0.42560553550720215, Class Accuracy: 0.3278910791020045
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.3278910791020045









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.50it/s]
  0%|                                                                                            | 0/19 [00:00<?, ?it/s]
Train Epoch Accuracy: 0.39965397119522095
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.87it/s]
  0%|                                                                                            | 0/73 [00:00<?, ?it/s]
TEST (inference) time: 1.9429900646209717s
Test Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.3275852220747141
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.3278910791020045










 96%|███████████████████████████████████████████████████████████████████████████████▌   | 70/73 [00:20<00:00,  3.46it/s]
Train Epoch Accuracy: 0.4057093560695648
100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.49it/s]
 58%|████████████████████████████████████████████████                                   | 11/19 [00:01<00:00,  9.62it/s]
TEST (inference) time: 1.9373469352722168s
Test Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.33007904612950945
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.33007904612950945
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.90it/s]









100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:20<00:00,  3.49it/s]
 16%|█████████████▎                                                                      | 3/19 [00:00<00:02,  7.49it/s]
Train Epoch Accuracy: 0.30709341168403625
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00,  9.85it/s]
  1%|█▏                                                                                  | 1/73 [00:00<00:12,  5.95it/s]
TEST (inference) time: 1.9496746063232422s
Test Instance Accuracy: 0.2024221420288086, Class Accuracy: 0.17418967025366666
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.33007904612950945










100%|███████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.40it/s]
 37%|██████████████████████████████▉                                                     | 7/19 [00:00<00:01,  8.06it/s]
Train Epoch Accuracy: 0.2733564078807831
100%|███████████████████████████████████████████████████████████████████████████████████| 19/19 [00:02<00:00,  8.97it/s]
  4%|███▍                                                                                | 3/73 [00:00<00:16,  4.36it/s]
TEST (inference) time: 2.137995481491089s
Test Instance Accuracy: 0.3356401324272156, Class Accuracy: 0.19531731922660278
Best Instance Accuracy: 0.4290657341480255, Class Accuracy: 0.33007904612950945



 34%|████████████████████████████▍                                                      | 25/73 [00:07<00:14,  3.36it/s]
Traceback (most recent call last):
  File "train_cls.py", line 305, in <module>
    main(args)
  File "train_cls.py", line 242, in main
    pred, trans_feat = classifier(points)
  File "/home/sssak_feng/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/c/users/sssak/desktop/VNPerformer/models/vn_transformer_cls.py", line 43, in forward
    x = layers(x, x, x)  # B, C, 3, N
  File "/home/sssak_feng/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/c/users/sssak/desktop/VNPerformer/models/TransformerEncoder.py", line 98, in forward
    out = self.ln_attn(out.permute(0, 3, 1, 2)).permute(0, 2, 3, 1)  # B, N, C, 3
  File "/home/sssak_feng/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/c/users/sssak/desktop/VNPerformer/models/vn_layers.py", line 222, in forward
    norm_ = torch.matmul(norm_, torch.ones((1, P)).cuda())
KeyboardInterrupt